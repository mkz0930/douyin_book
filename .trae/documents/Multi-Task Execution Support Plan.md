# 多任务执行与 Todo 队列支持计划 (修正版)

## 1. 目标
支持多任务执行，优先处理 `data/` 下的文件，随后处理 `data/todo/` 下的文件。保持核心生成流程（脚本、视频等）一致，仅针对 `todo` 目录下的源文件处理进行特定调整。

## 2. 修改 `main.py`

### 2.1 代码重构
提取核心处理逻辑为 `process_book` 函数。

### 2.2 执行顺序
1.  **优先级 1**: 扫描并处理 `data/*.txt`（标准输入）。
2.  **优先级 2**: 扫描并处理 `data/todo/*.txt`（Todo 队列）。

### 2.3 文件归档策略
在处理完成后，根据文件来源执行不同的清理操作：

1.  **历史归档 (History)**:
    -   无论来源如何，**处理后的内容**都会被保存到 `data/history/<书名>.txt`。
    -   这确保了 `history` 目录下的文件总是以书名命名，方便查找。

2.  **源文件处理 (Source File Cleanup)**:
    -   **来自 `data/`**:
        -   直接将源文件**移动**并重命名到 `data/history/<书名>.txt`（现有逻辑）。
        -   结果：`data/` 下的原文件消失。
    -   **来自 `data/todo/`**:
        -   先将内容**写入**到 `data/history/<书名>.txt`。
        -   然后**清空** `data/todo/` 下的源文件内容（保留空文件）。
        -   结果：`data/todo/` 下的原文件保留但为空，内容已归档至 history。

## 3. 目录结构
-   确保创建 `data/todo/` 目录。

## 4. 验证
-   验证 `data/input.txt` 正常处理并移动。
-   验证 `data/todo/task.txt` 正常处理，处理后文件变为空，且 `data/history/` 中出现了对应的 `<书名>.txt`。
